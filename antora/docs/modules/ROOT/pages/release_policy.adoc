= Release Policy

:numbered:

These rules are applied to pipeline run attestations associated with container images built by Konflux.

== Available rule collections

[cols="2,6"]
|===
|*Name*
|*Description*

| [#github]`github`
a| A set of policy rules to validate artifacts built on GitHub.

Rules included:
        
* xref:packages/release_github_certificate.adoc#github_certificate__gh_workflow_extensions[GitHub Certificate Checks: GitHub Workflow Certificate Extensions]        
* xref:packages/release_github_certificate.adoc#github_certificate__gh_workflow_name[GitHub Certificate Checks: GitHub Workflow Name]        
* xref:packages/release_github_certificate.adoc#github_certificate__gh_workflow_repository[GitHub Certificate Checks: GitHub Workflow Repository]        
* xref:packages/release_github_certificate.adoc#github_certificate__gh_workflow_ref[GitHub Certificate Checks: GitHub Workflow Repository]        
* xref:packages/release_github_certificate.adoc#github_certificate__gh_workflow_trigger[GitHub Certificate Checks: GitHub Workflow Trigger]        
* xref:packages/release_github_certificate.adoc#github_certificate__rule_data_provided[GitHub Certificate Checks: Rule data provided]

| [#minimal]`minimal`
a| Includes a minimal set of policy rules to ensure the build pipeline is functioning as expected, and able to produce signed attestations of the expected type.

Rules included:
        
* xref:packages/release_attestation_type.adoc#attestation_type__deprecated_policy_attestation_format[Attestation type: Deprecated policy attestation format]        
* xref:packages/release_attestation_type.adoc#attestation_type__known_attestation_type[Attestation type: Known attestation type found]        
* xref:packages/release_attestation_type.adoc#attestation_type__known_attestation_types_provided[Attestation type: Known attestation types provided]        
* xref:packages/release_attestation_type.adoc#attestation_type__pipelinerun_attestation_found[Attestation type: PipelineRun attestation found]        
* xref:packages/release_base_image_registries.adoc#base_image_registries__allowed_registries_provided[Base image checks: Allowed base image registry prefixes list was provided]        
* xref:packages/release_base_image_registries.adoc#base_image_registries__base_image_permitted[Base image checks: Base image comes from permitted registry]        
* xref:packages/release_base_image_registries.adoc#base_image_registries__base_image_info_found[Base image checks: Base images provided]        
* xref:packages/release_cve.adoc#cve__cve_blockers[CVE checks: Blocking CVE check]        
* xref:packages/release_cve.adoc#cve__unpatched_cve_blockers[CVE checks: Blocking unpatched CVE check]        
* xref:packages/release_cve.adoc#cve__cve_results_found[CVE checks: CVE scan results found]        
* xref:packages/release_cve.adoc#cve__cve_warnings[CVE checks: Non-blocking CVE check]        
* xref:packages/release_cve.adoc#cve__unpatched_cve_warnings[CVE checks: Non-blocking unpatched CVE check]        
* xref:packages/release_cve.adoc#cve__rule_data_provided[CVE checks: Rule data provided]        
* xref:packages/release_provenance_materials.adoc#provenance_materials__git_clone_source_matches_provenance[Provenance Materials: Git clone source matches materials provenance]        
* xref:packages/release_provenance_materials.adoc#provenance_materials__git_clone_task_found[Provenance Materials: Git clone task found]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__valid[SBOM CycloneDX: Valid]        
* xref:packages/release_sbom.adoc#sbom__found[SBOM: Found]        
* xref:packages/release_slsa_provenance_available.adoc#slsa_provenance_available__allowed_predicate_types_provided[SLSA - Provenance - Available: Allowed predicate types provided]        
* xref:packages/release_slsa_provenance_available.adoc#slsa_provenance_available__attestation_predicate_type_accepted[SLSA - Provenance - Available: Expected attestation predicate type found]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_uri_is_git_repo[SLSA - Source - Version Controlled: Material uri is a git repo]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_format_okay[SLSA - Source - Version Controlled: Materials have uri and digest]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_include_git_sha[SLSA - Source - Version Controlled: Materials include git commit shas]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__expected_source_code_reference[SLSA - Verification model - Source: Expected source code reference]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__rule_data_provided[SLSA - Verification model - Source: Rule data provided]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__source_code_reference_provided[SLSA - Verification model - Source: Source code reference provided]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__attested_source_code_reference[SLSA - Verification model - Source: Source reference]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__valid[SPDX SBOM: Valid]        
* xref:packages/release_tasks.adoc#tasks__pipeline_has_tasks[Tasks: Pipeline run includes at least one task]        
* xref:packages/release_tasks.adoc#tasks__successful_pipeline_tasks[Tasks: Successful pipeline tasks]

| [#policy_data]`policy_data`
a| Include policy rules responsible for validating rule data.

Rules included:
        
* xref:packages/release_attestation_type.adoc#attestation_type__known_attestation_types_provided[Attestation type: Known attestation types provided]        
* xref:packages/release_base_image_registries.adoc#base_image_registries__allowed_registries_provided[Base image checks: Allowed base image registry prefixes list was provided]        
* xref:packages/release_buildah_build_task.adoc#buildah_build_task__disallowed_platform_patterns_pattern[Buildah build task: disallowed_platform_patterns format]        
* xref:packages/release_cve.adoc#cve__rule_data_provided[CVE checks: Rule data provided]        
* xref:packages/release_external_parameters.adoc#external_parameters__pipeline_run_params_provided[External parameters: PipelineRun params provided]        
* xref:packages/release_github_certificate.adoc#github_certificate__rule_data_provided[GitHub Certificate Checks: Rule data provided]        
* xref:packages/release_labels.adoc#labels__rule_data_provided[Labels: Rule data provided]        
* xref:packages/release_olm.adoc#olm__required_olm_features_annotations_provided[OLM: Required OLM feature annotations list provided]        
* xref:packages/release_rpm_repos.adoc#rpm_repos__rule_data_provided[RPM Repos: Known repo id list provided]        
* xref:packages/release_rpm_signature.adoc#rpm_signature__rule_data_provided[RPM Signature: Rule data provided]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__allowed_package_external_references[SBOM CycloneDX: Allowed package external references]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__allowed_package_sources[SBOM CycloneDX: Allowed package sources]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__disallowed_package_attributes[SBOM CycloneDX: Disallowed package attributes]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__disallowed_package_external_references[SBOM CycloneDX: Disallowed package external references]        
* xref:packages/release_sbom.adoc#sbom__disallowed_packages_provided[SBOM: Disallowed packages list is provided]        
* xref:packages/release_slsa_build_build_service.adoc#slsa_build_build_service__allowed_builder_ids_provided[SLSA - Build - Build Service: Allowed builder IDs provided]        
* xref:packages/release_slsa_provenance_available.adoc#slsa_provenance_available__allowed_predicate_types_provided[SLSA - Provenance - Available: Allowed predicate types provided]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__rule_data_provided[SLSA - Verification model - Source: Rule data provided]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__allowed_package_external_references[SPDX SBOM: Allowed package external references]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__allowed_package_sources[SPDX SBOM: Allowed package sources]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__disallowed_package_attributes[SPDX SBOM: Disallowed package attributes]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__disallowed_package_external_references[SPDX SBOM: Disallowed package external references]        
* xref:packages/release_schedule.adoc#schedule__rule_data_provided[Schedule related checks: Rule data provided]        
* xref:packages/release_tasks.adoc#tasks__data_provided[Tasks: Data provided]        
* xref:packages/release_test.adoc#test__rule_data_provided[Test: Rule data provided]        
* xref:packages/release_trusted_task.adoc#trusted_task__data_format[Trusted Task checks: Data format]

| [#redhat]`redhat`
a| Include the set of policy rules required for Red Hat products.

Rules included:
        
* xref:packages/release_attestation_type.adoc#attestation_type__deprecated_policy_attestation_format[Attestation type: Deprecated policy attestation format]        
* xref:packages/release_attestation_type.adoc#attestation_type__known_attestation_type[Attestation type: Known attestation type found]        
* xref:packages/release_attestation_type.adoc#attestation_type__known_attestation_types_provided[Attestation type: Known attestation types provided]        
* xref:packages/release_attestation_type.adoc#attestation_type__pipelinerun_attestation_found[Attestation type: PipelineRun attestation found]        
* xref:packages/release_base_image_registries.adoc#base_image_registries__allowed_registries_provided[Base image checks: Allowed base image registry prefixes list was provided]        
* xref:packages/release_base_image_registries.adoc#base_image_registries__base_image_permitted[Base image checks: Base image comes from permitted registry]        
* xref:packages/release_base_image_registries.adoc#base_image_registries__base_image_info_found[Base image checks: Base images provided]        
* xref:packages/release_buildah_build_task.adoc#buildah_build_task__add_capabilities_param[Buildah build task: ADD_CAPABILITIES parameter]        
* xref:packages/release_buildah_build_task.adoc#buildah_build_task__buildah_uses_local_dockerfile[Buildah build task: Buildah task uses a local Dockerfile]        
* xref:packages/release_buildah_build_task.adoc#buildah_build_task__platform_param[Buildah build task: PLATFORM parameter]        
* xref:packages/release_buildah_build_task.adoc#buildah_build_task__privileged_nested_param[Buildah build task: PRIVILEGED_NESTED parameter]        
* xref:packages/release_buildah_build_task.adoc#buildah_build_task__disallowed_platform_patterns_pattern[Buildah build task: disallowed_platform_patterns format]        
* xref:packages/release_cve.adoc#cve__cve_blockers[CVE checks: Blocking CVE check]        
* xref:packages/release_cve.adoc#cve__unpatched_cve_blockers[CVE checks: Blocking unpatched CVE check]        
* xref:packages/release_cve.adoc#cve__cve_results_found[CVE checks: CVE scan results found]        
* xref:packages/release_cve.adoc#cve__cve_warnings[CVE checks: Non-blocking CVE check]        
* xref:packages/release_cve.adoc#cve__unpatched_cve_warnings[CVE checks: Non-blocking unpatched CVE check]        
* xref:packages/release_cve.adoc#cve__rule_data_provided[CVE checks: Rule data provided]        
* xref:packages/release_hermetic_task.adoc#hermetic_task__hermetic[Hermetic task: Task called with hermetic param set]        
* xref:packages/release_labels.adoc#labels__deprecated_labels[Labels: Deprecated labels]        
* xref:packages/release_labels.adoc#labels__disallowed_inherited_labels[Labels: Disallowed inherited labels]        
* xref:packages/release_labels.adoc#labels__inaccessible_config[Labels: Inaccessible image config]        
* xref:packages/release_labels.adoc#labels__inaccessible_manifest[Labels: Inaccessible image manifest]        
* xref:packages/release_labels.adoc#labels__inaccessible_parent_config[Labels: Inaccessible parent image config]        
* xref:packages/release_labels.adoc#labels__inaccessible_parent_manifest[Labels: Inaccessible parent image manifest]        
* xref:packages/release_labels.adoc#labels__optional_labels[Labels: Optional labels]        
* xref:packages/release_labels.adoc#labels__required_labels[Labels: Required labels]        
* xref:packages/release_labels.adoc#labels__rule_data_provided[Labels: Rule data provided]        
* xref:packages/release_olm.adoc#olm__csv_semver_format[OLM: ClusterServiceVersion semver format]        
* xref:packages/release_olm.adoc#olm__feature_annotations_format[OLM: Feature annotations have expected value]        
* xref:packages/release_olm.adoc#olm__allowed_registries[OLM: Images referenced by OLM bundle are from allowed registries]        
* xref:packages/release_olm.adoc#olm__olm_bundle_multi_arch[OLM: OLM bundle images are not multi-arch]        
* xref:packages/release_olm.adoc#olm__allowed_registries_related[OLM: Related images references are from allowed registries]        
* xref:packages/release_olm.adoc#olm__required_olm_features_annotations_provided[OLM: Required OLM feature annotations list provided]        
* xref:packages/release_olm.adoc#olm__subscriptions_annotation_format[OLM: Subscription annotation has expected value]        
* xref:packages/release_olm.adoc#olm__inaccessible_related_images[OLM: Unable to access related images for a component]        
* xref:packages/release_olm.adoc#olm__unmapped_references[OLM: Unmapped images in OLM bundle]        
* xref:packages/release_olm.adoc#olm__unpinned_references[OLM: Unpinned images in OLM bundle]        
* xref:packages/release_olm.adoc#olm__unpinned_snapshot_references[OLM: Unpinned images in input snapshot]        
* xref:packages/release_pre_build_script_task.adoc#pre_build_script_task__pre_build_script_task_runner_image_allowed[Pre-build-script task checks: Script runner image comes from allowed registry]        
* xref:packages/release_pre_build_script_task.adoc#pre_build_script_task__valid_pre_build_script_task_runner_image_ref[Pre-build-script task checks: Script runner image is a valid image reference]        
* xref:packages/release_pre_build_script_task.adoc#pre_build_script_task__pre_build_script_task_runner_image_in_sbom[Pre-build-script task checks: Script runner image is included in the sbom]        
* xref:packages/release_pre_build_script_task.adoc#pre_build_script_task__pre_build_script_task_runner_image_in_results[Pre-build-script task checks: Script runner image is listed in the task results]        
* xref:packages/release_provenance_materials.adoc#provenance_materials__git_clone_source_matches_provenance[Provenance Materials: Git clone source matches materials provenance]        
* xref:packages/release_provenance_materials.adoc#provenance_materials__git_clone_task_found[Provenance Materials: Git clone task found]        
* xref:packages/release_quay_expiration.adoc#quay_expiration__expires_label[Quay expiration: Expires label]        
* xref:packages/release_rpm_packages.adoc#rpm_packages__unique_version[RPM Packages: Unique Version]        
* xref:packages/release_rpm_repos.adoc#rpm_repos__ids_known[RPM Repos: All rpms have known repo ids]        
* xref:packages/release_rpm_repos.adoc#rpm_repos__rule_data_provided[RPM Repos: Known repo id list provided]        
* xref:packages/release_rpm_signature.adoc#rpm_signature__allowed[RPM Signature: Allowed RPM signature key]        
* xref:packages/release_rpm_signature.adoc#rpm_signature__result_format[RPM Signature: Result format]        
* xref:packages/release_rpm_signature.adoc#rpm_signature__rule_data_provided[RPM Signature: Rule data provided]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__allowed[SBOM CycloneDX: Allowed]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__allowed_package_external_references[SBOM CycloneDX: Allowed package external references]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__allowed_package_sources[SBOM CycloneDX: Allowed package sources]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__disallowed_package_attributes[SBOM CycloneDX: Disallowed package attributes]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__disallowed_package_external_references[SBOM CycloneDX: Disallowed package external references]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__valid[SBOM CycloneDX: Valid]        
* xref:packages/release_sbom.adoc#sbom__disallowed_packages_provided[SBOM: Disallowed packages list is provided]        
* xref:packages/release_sbom.adoc#sbom__found[SBOM: Found]        
* xref:packages/release_slsa_build_build_service.adoc#slsa_build_build_service__allowed_builder_ids_provided[SLSA - Build - Build Service: Allowed builder IDs provided]        
* xref:packages/release_slsa_build_build_service.adoc#slsa_build_build_service__slsa_builder_id_found[SLSA - Build - Build Service: SLSA Builder ID found]        
* xref:packages/release_slsa_build_build_service.adoc#slsa_build_build_service__slsa_builder_id_accepted[SLSA - Build - Build Service: SLSA Builder ID is known and accepted]        
* xref:packages/release_slsa_build_scripted_build.adoc#slsa_build_scripted_build__build_script_used[SLSA - Build - Scripted Build: Build task contains steps]        
* xref:packages/release_slsa_build_scripted_build.adoc#slsa_build_scripted_build__build_task_image_results_found[SLSA - Build - Scripted Build: Build task set image digest and url task results]        
* xref:packages/release_slsa_build_scripted_build.adoc#slsa_build_scripted_build__image_built_by_trusted_task[SLSA - Build - Scripted Build: Image built by trusted Task]        
* xref:packages/release_slsa_build_scripted_build.adoc#slsa_build_scripted_build__subject_build_task_matches[SLSA - Build - Scripted Build: Provenance subject matches build task image result]        
* xref:packages/release_slsa_provenance_available.adoc#slsa_provenance_available__allowed_predicate_types_provided[SLSA - Provenance - Available: Allowed predicate types provided]        
* xref:packages/release_slsa_provenance_available.adoc#slsa_provenance_available__attestation_predicate_type_accepted[SLSA - Provenance - Available: Expected attestation predicate type found]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_uri_is_git_repo[SLSA - Source - Version Controlled: Material uri is a git repo]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_format_okay[SLSA - Source - Version Controlled: Materials have uri and digest]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_include_git_sha[SLSA - Source - Version Controlled: Materials include git commit shas]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__expected_source_code_reference[SLSA - Verification model - Source: Expected source code reference]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__rule_data_provided[SLSA - Verification model - Source: Rule data provided]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__source_code_reference_provided[SLSA - Verification model - Source: Source code reference provided]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__attested_source_code_reference[SLSA - Verification model - Source: Source reference]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__allowed[SPDX SBOM: Allowed]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__allowed_package_external_references[SPDX SBOM: Allowed package external references]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__allowed_package_sources[SPDX SBOM: Allowed package sources]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__disallowed_package_attributes[SPDX SBOM: Disallowed package attributes]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__disallowed_package_external_references[SPDX SBOM: Disallowed package external references]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__valid[SPDX SBOM: Valid]        
* xref:packages/release_schedule.adoc#schedule__date_restriction[Schedule related checks: Date Restriction]        
* xref:packages/release_schedule.adoc#schedule__rule_data_provided[Schedule related checks: Rule data provided]        
* xref:packages/release_schedule.adoc#schedule__weekday_restriction[Schedule related checks: Weekday Restriction]        
* xref:packages/release_source_image.adoc#source_image__exists[Source image: Exists]        
* xref:packages/release_source_image.adoc#source_image__signed[Source image: Signed]        
* xref:packages/release_tasks.adoc#tasks__required_untrusted_task_found[Tasks: All required tasks are from trusted tasks]        
* xref:packages/release_tasks.adoc#tasks__required_tasks_found[Tasks: All required tasks were included in the pipeline]        
* xref:packages/release_tasks.adoc#tasks__data_provided[Tasks: Data provided]        
* xref:packages/release_tasks.adoc#tasks__future_required_tasks_found[Tasks: Future required tasks were found]        
* xref:packages/release_tasks.adoc#tasks__pinned_task_refs[Tasks: Pinned Task references]        
* xref:packages/release_tasks.adoc#tasks__pipeline_has_tasks[Tasks: Pipeline run includes at least one task]        
* xref:packages/release_tasks.adoc#tasks__pipeline_required_tasks_list_provided[Tasks: Required tasks list for pipeline was provided]        
* xref:packages/release_tasks.adoc#tasks__required_tasks_list_provided[Tasks: Required tasks list was provided]        
* xref:packages/release_tasks.adoc#tasks__successful_pipeline_tasks[Tasks: Successful pipeline tasks]        
* xref:packages/release_tasks.adoc#tasks__unsupported[Tasks: Task version unsupported]        
* xref:packages/release_test.adoc#test__test_all_images[Test: Image digest is present in IMAGES_PROCESSED result]        
* xref:packages/release_test.adoc#test__no_failed_informative_tests[Test: No informative tests failed]        
* xref:packages/release_test.adoc#test__no_erred_tests[Test: No tests erred]        
* xref:packages/release_test.adoc#test__no_failed_tests[Test: No tests failed]        
* xref:packages/release_test.adoc#test__no_test_warnings[Test: No tests produced warnings]        
* xref:packages/release_test.adoc#test__no_skipped_tests[Test: No tests were skipped]        
* xref:packages/release_test.adoc#test__test_results_known[Test: No unsupported test result values found]        
* xref:packages/release_test.adoc#test__rule_data_provided[Test: Rule data provided]        
* xref:packages/release_test.adoc#test__test_data_found[Test: Test data found in task results]        
* xref:packages/release_test.adoc#test__test_results_found[Test: Test data includes results key]        
* xref:packages/release_trusted_task.adoc#trusted_task__data_format[Trusted Task checks: Data format]        
* xref:packages/release_trusted_task.adoc#trusted_task__pinned[Trusted Task checks: Task references are pinned]        
* xref:packages/release_trusted_task.adoc#trusted_task__tagged[Trusted Task checks: Task references are tagged]        
* xref:packages/release_trusted_task.adoc#trusted_task__data[Trusted Task checks: Task tracking data was provided]        
* xref:packages/release_trusted_task.adoc#trusted_task__trusted[Trusted Task checks: Tasks are trusted]        
* xref:packages/release_trusted_task.adoc#trusted_task__current[Trusted Task checks: Tasks using the latest versions]        
* xref:packages/release_trusted_task.adoc#trusted_task__valid_trusted_artifact_inputs[Trusted Task checks: Trusted Artifact produced in pipeline]        
* xref:packages/release_trusted_task.adoc#trusted_task__trusted_parameters[Trusted Task checks: Trusted parameters]        
* xref:packages/release_rpm_ostree_task.adoc#rpm_ostree_task__builder_image_param[rpm-ostree Task: Builder image parameter]        
* xref:packages/release_rpm_ostree_task.adoc#rpm_ostree_task__rule_data[rpm-ostree Task: Rule data]

| [#redhat_rpms]`redhat_rpms`
a| Include the set of policy rules required for building Red Hat RPMs.

Rules included:
        
* xref:packages/release_attestation_type.adoc#attestation_type__deprecated_policy_attestation_format[Attestation type: Deprecated policy attestation format]        
* xref:packages/release_attestation_type.adoc#attestation_type__known_attestation_type[Attestation type: Known attestation type found]        
* xref:packages/release_attestation_type.adoc#attestation_type__known_attestation_types_provided[Attestation type: Known attestation types provided]        
* xref:packages/release_attestation_type.adoc#attestation_type__pipelinerun_attestation_found[Attestation type: PipelineRun attestation found]        
* xref:packages/release_cve.adoc#cve__unpatched_cve_blockers[CVE checks: Blocking unpatched CVE check]        
* xref:packages/release_cve.adoc#cve__cve_warnings[CVE checks: Non-blocking CVE check]        
* xref:packages/release_cve.adoc#cve__rule_data_provided[CVE checks: Rule data provided]        
* xref:packages/release_git_branch.adoc#git_branch__git_branch[Git branch checks: Only allow builds from a trusted branch]        
* xref:packages/release_provenance_materials.adoc#provenance_materials__git_clone_source_matches_provenance[Provenance Materials: Git clone source matches materials provenance]        
* xref:packages/release_provenance_materials.adoc#provenance_materials__git_clone_task_found[Provenance Materials: Git clone task found]        
* xref:packages/release_rpm_pipeline.adoc#rpm_pipeline__invalid_pipeline[RPM Pipeline: Task version invalid_pipeline]        
* xref:packages/release_rpm_repos.adoc#rpm_repos__ids_known[RPM Repos: All rpms have known repo ids]        
* xref:packages/release_rpm_repos.adoc#rpm_repos__rule_data_provided[RPM Repos: Known repo id list provided]        
* xref:packages/release_rpm_signature.adoc#rpm_signature__allowed[RPM Signature: Allowed RPM signature key]        
* xref:packages/release_rpm_signature.adoc#rpm_signature__result_format[RPM Signature: Result format]        
* xref:packages/release_rpm_signature.adoc#rpm_signature__rule_data_provided[RPM Signature: Rule data provided]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__allowed[SBOM CycloneDX: Allowed]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__allowed_package_external_references[SBOM CycloneDX: Allowed package external references]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__allowed_package_sources[SBOM CycloneDX: Allowed package sources]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__disallowed_package_attributes[SBOM CycloneDX: Disallowed package attributes]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__disallowed_package_external_references[SBOM CycloneDX: Disallowed package external references]        
* xref:packages/release_sbom_cyclonedx.adoc#sbom_cyclonedx__valid[SBOM CycloneDX: Valid]        
* xref:packages/release_sbom.adoc#sbom__disallowed_packages_provided[SBOM: Disallowed packages list is provided]        
* xref:packages/release_slsa_build_build_service.adoc#slsa_build_build_service__allowed_builder_ids_provided[SLSA - Build - Build Service: Allowed builder IDs provided]        
* xref:packages/release_slsa_build_build_service.adoc#slsa_build_build_service__slsa_builder_id_accepted[SLSA - Build - Build Service: SLSA Builder ID is known and accepted]        
* xref:packages/release_slsa_build_scripted_build.adoc#slsa_build_scripted_build__build_script_used[SLSA - Build - Scripted Build: Build task contains steps]        
* xref:packages/release_slsa_build_scripted_build.adoc#slsa_build_scripted_build__build_task_image_results_found[SLSA - Build - Scripted Build: Build task set image digest and url task results]        
* xref:packages/release_slsa_build_scripted_build.adoc#slsa_build_scripted_build__subject_build_task_matches[SLSA - Build - Scripted Build: Provenance subject matches build task image result]        
* xref:packages/release_slsa_provenance_available.adoc#slsa_provenance_available__allowed_predicate_types_provided[SLSA - Provenance - Available: Allowed predicate types provided]        
* xref:packages/release_slsa_provenance_available.adoc#slsa_provenance_available__attestation_predicate_type_accepted[SLSA - Provenance - Available: Expected attestation predicate type found]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_uri_is_git_repo[SLSA - Source - Version Controlled: Material uri is a git repo]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_format_okay[SLSA - Source - Version Controlled: Materials have uri and digest]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_include_git_sha[SLSA - Source - Version Controlled: Materials include git commit shas]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__rule_data_provided[SLSA - Verification model - Source: Rule data provided]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__source_code_reference_provided[SLSA - Verification model - Source: Source code reference provided]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__allowed[SPDX SBOM: Allowed]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__allowed_package_external_references[SPDX SBOM: Allowed package external references]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__allowed_package_sources[SPDX SBOM: Allowed package sources]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__disallowed_package_attributes[SPDX SBOM: Disallowed package attributes]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__disallowed_package_external_references[SPDX SBOM: Disallowed package external references]        
* xref:packages/release_sbom_spdx.adoc#sbom_spdx__valid[SPDX SBOM: Valid]        
* xref:packages/release_schedule.adoc#schedule__date_restriction[Schedule related checks: Date Restriction]        
* xref:packages/release_schedule.adoc#schedule__rule_data_provided[Schedule related checks: Rule data provided]        
* xref:packages/release_schedule.adoc#schedule__weekday_restriction[Schedule related checks: Weekday Restriction]        
* xref:packages/release_tasks.adoc#tasks__required_untrusted_task_found[Tasks: All required tasks are from trusted tasks]        
* xref:packages/release_tasks.adoc#tasks__data_provided[Tasks: Data provided]        
* xref:packages/release_tasks.adoc#tasks__future_required_tasks_found[Tasks: Future required tasks were found]        
* xref:packages/release_tasks.adoc#tasks__pipeline_has_tasks[Tasks: Pipeline run includes at least one task]        
* xref:packages/release_tasks.adoc#tasks__pipeline_required_tasks_list_provided[Tasks: Required tasks list for pipeline was provided]        
* xref:packages/release_tasks.adoc#tasks__required_tasks_list_provided[Tasks: Required tasks list was provided]        
* xref:packages/release_tasks.adoc#tasks__successful_pipeline_tasks[Tasks: Successful pipeline tasks]        
* xref:packages/release_tasks.adoc#tasks__unsupported[Tasks: Task version unsupported]        
* xref:packages/release_test.adoc#test__test_all_images[Test: Image digest is present in IMAGES_PROCESSED result]        
* xref:packages/release_test.adoc#test__no_erred_tests[Test: No tests erred]        
* xref:packages/release_test.adoc#test__no_failed_tests[Test: No tests failed]        
* xref:packages/release_test.adoc#test__no_skipped_tests[Test: No tests were skipped]        
* xref:packages/release_test.adoc#test__test_results_known[Test: No unsupported test result values found]        
* xref:packages/release_test.adoc#test__rule_data_provided[Test: Rule data provided]        
* xref:packages/release_test.adoc#test__test_results_found[Test: Test data includes results key]        
* xref:packages/release_trusted_task.adoc#trusted_task__data_format[Trusted Task checks: Data format]        
* xref:packages/release_trusted_task.adoc#trusted_task__pinned[Trusted Task checks: Task references are pinned]        
* xref:packages/release_trusted_task.adoc#trusted_task__tagged[Trusted Task checks: Task references are tagged]        
* xref:packages/release_trusted_task.adoc#trusted_task__data[Trusted Task checks: Task tracking data was provided]        
* xref:packages/release_trusted_task.adoc#trusted_task__current[Trusted Task checks: Tasks using the latest versions]        
* xref:packages/release_trusted_task.adoc#trusted_task__valid_trusted_artifact_inputs[Trusted Task checks: Trusted Artifact produced in pipeline]

| [#rhtap-multi-ci]`rhtap-multi-ci`
a| A set of policy rules to validate artifacts built using RHTAP Multi-CI pipelines.

Rules included:
        
* xref:packages/release_rhtap_multi_ci.adoc#rhtap_multi_ci__attestation_format[RHTAP Multi-CI: SLSA Provenance Attestation Format]        
* xref:packages/release_rhtap_multi_ci.adoc#rhtap_multi_ci__attestation_found[RHTAP Multi-CI: SLSA Provenance Attestation Found]

| [#slsa3]`slsa3`
a| Includes policy rules required to meet SLSA Level 3.

Rules included:
        
* xref:packages/release_slsa_build_build_service.adoc#slsa_build_build_service__allowed_builder_ids_provided[SLSA - Build - Build Service: Allowed builder IDs provided]        
* xref:packages/release_slsa_build_build_service.adoc#slsa_build_build_service__slsa_builder_id_found[SLSA - Build - Build Service: SLSA Builder ID found]        
* xref:packages/release_slsa_build_build_service.adoc#slsa_build_build_service__slsa_builder_id_accepted[SLSA - Build - Build Service: SLSA Builder ID is known and accepted]        
* xref:packages/release_slsa_build_scripted_build.adoc#slsa_build_scripted_build__build_script_used[SLSA - Build - Scripted Build: Build task contains steps]        
* xref:packages/release_slsa_build_scripted_build.adoc#slsa_build_scripted_build__build_task_image_results_found[SLSA - Build - Scripted Build: Build task set image digest and url task results]        
* xref:packages/release_slsa_build_scripted_build.adoc#slsa_build_scripted_build__subject_build_task_matches[SLSA - Build - Scripted Build: Provenance subject matches build task image result]        
* xref:packages/release_slsa_provenance_available.adoc#slsa_provenance_available__allowed_predicate_types_provided[SLSA - Provenance - Available: Allowed predicate types provided]        
* xref:packages/release_slsa_provenance_available.adoc#slsa_provenance_available__attestation_predicate_type_accepted[SLSA - Provenance - Available: Expected attestation predicate type found]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_uri_is_git_repo[SLSA - Source - Version Controlled: Material uri is a git repo]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_format_okay[SLSA - Source - Version Controlled: Materials have uri and digest]        
* xref:packages/release_slsa_source_version_controlled.adoc#slsa_source_version_controlled__materials_include_git_sha[SLSA - Source - Version Controlled: Materials include git commit shas]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__expected_source_code_reference[SLSA - Verification model - Source: Expected source code reference]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__rule_data_provided[SLSA - Verification model - Source: Rule data provided]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__source_code_reference_provided[SLSA - Verification model - Source: Source code reference provided]        
* xref:packages/release_slsa_source_correlated.adoc#slsa_source_correlated__attested_source_code_reference[SLSA - Verification model - Source: Source reference]        
* xref:packages/release_tasks.adoc#tasks__pipeline_has_tasks[Tasks: Pipeline run includes at least one task]        
* xref:packages/release_tasks.adoc#tasks__successful_pipeline_tasks[Tasks: Successful pipeline tasks]
|===

== Available Packages

[cols="2,6"]
|===
|*Package Name*
|*Description*

| xref:packages/release_attestation_type.adoc[attestation_type]
a| Sanity checks related to the format of the image build's attestation.

| xref:packages/release_base_image_registries.adoc[base_image_registries]
a| This package is responsible for verifying the base (parent) images reported in the SLSA Provenace or the SBOM are allowed.

| xref:packages/release_buildah_build_task.adoc[buildah_build_task]
a| This package is responsible for verifying the buildah build task

| xref:packages/release_cve.adoc[cve]
a| This package is responsible for verifying a CVE scan was performed during the build pipeline, and that the image under test does not contain CVEs of certain security levels.

The behaviour of the rules in this package is influenced by rule data. Firstly the rules can be configured to emit violations or warnings based on the availability of the vulnerability fix: patched -- if there is a remediation available, e.g. new version with a fix, or unpatched -- if there is, currently, no remidiation available. Secondly per severity: critical, high, medium, low or unknown choice can be made of the rule outcome: failure or warning. And lastly, per severity, choice can be made of how many leeway days are allowed before a vulnerability causing a failure will be reported as a warning instead.

In the following example if rule data configuration, failures will be reported for critical and high patched vulnerabilities, for critical unpatched vulnerabilities only, warnings will be reported for medium and low patched, and for high and medium unpatched vulnerabilities. For critical and high patched vulnerabilities a leeway of 10 days is allowed.

.Example rule data
[source,yaml]
----
restrict_cve_security_levels:
  - critical
  - high
warn_cve_security_levels:
  - medium
  - low
restrict_unpatched_cve_security_levels:
  - critical
warn_unpatched_cve_security_levels:
  - high
  - medium
cve_leeway:
  critical: 10
  high: 10
----

| xref:packages/release_external_parameters.adoc[external_parameters]
a| Verify the attribute .predicate.buildDefinition.externalParameters of a SLSA Provenance v1.0 matches the expectation.

| xref:packages/release_git_branch.adoc[git_branch]
a| Check that the build was done from an expected git branch. The specific branches permitted are specified as a list of regexes in the `allowed_branch_patterns` rule data.

| xref:packages/release_github_certificate.adoc[github_certificate]
a| Verify attributes on the certificate involved in the image signature when using slsa-github-generator on GitHub Actions with Sigstore Fulcio

| xref:packages/release_hermetic_task.adoc[hermetic_task]
a| This package verifies that all the tasks in the attestation that are required to be hermetic were invoked with the proper parameters to perform a hermetic execution.

| xref:packages/release_labels.adoc[labels]
a| Check if the image has the expected labels set. The rules in this package distinguish file-based catalog (FBC) images from all other images. When checking an FBC image, a policy rule may use a different set of rule data. An FBC image is detected by the presence of the operators.operatorframework.io.index.configs.v1 label.

| xref:packages/release_olm.adoc[olm]
a| Checks for Operator Lifecycle Manager (OLM) bundles.

| xref:packages/release_pre_build_script_task.adoc[pre_build_script_task]
a| This package verifies that the pre-build-script tasks in the attestation are executed in a controlled environment

| xref:packages/release_provenance_materials.adoc[provenance_materials]
a| This package provides rules for verifying the contents of the materials section of the SLSA Provenance attestation.

| xref:packages/release_quay_expiration.adoc[quay_expiration]
a| Policies to prevent releasing an image to quay that has a quay expiration date. In Konflux images with an expiration date are produced by "on-pr" build pipelines, i.e. pre-merge CI builds, so this is intended to prevent accidentally releasing a CI build.

| xref:packages/release_rhtap_multi_ci.adoc[rhtap_multi_ci]
a| Checks for images built using an RHTAP build pipeline in either Jenkins, GitLab or GitHub. RHTAP pipelines are defined under https://github.com/redhat-appstudio/tssc-sample-templates/tree/main/skeleton/ci

| xref:packages/release_rpm_packages.adoc[rpm_packages]
a| Rules used to verify different properties of specific RPM packages found in the SBOM of the image being validated.

| xref:packages/release_rpm_pipeline.adoc[rpm_pipeline]
a| This package provides rules for verifying the RPMs are built in an approved pipeline

| xref:packages/release_rpm_repos.adoc[rpm_repos]
a| This package defines rules to confirm that all RPM packages listed in SBOMs specify a known and permitted repository id.

| xref:packages/release_rpm_signature.adoc[rpm_signature]
a| This package provides rules for verifying the signatures of RPMs identified in the the SLSA Provenance attestation.

| xref:packages/release_sbom.adoc[sbom]
a| Checks general properties of the SBOMs associated with the image being validated. More specific rules for SPDX and CycloneDX SBOMs are in separate packages.

| xref:packages/release_sbom_cyclonedx.adoc[sbom_cyclonedx]
a| Checks different properties of the CycloneDX SBOMs associated with the image being validated.

| xref:packages/release_slsa_build_build_service.adoc[slsa_build_build_service]
a| The SLSA requirement states the following:
"All build steps ran using some build service, not on a developer’s workstation."
This package verifies the requirement by asserting the image was built by Tekton Pipelines.

| xref:packages/release_slsa_build_scripted_build.adoc[slsa_build_scripted_build]
a| The SLSA requirement states the following:
"All build steps were fully defined in some sort of “build script”. The only manual command, if any, was to invoke the build script."
This package verifies the requirement by asserting the image was built by Tekton Pipelines.

| xref:packages/release_slsa_provenance_available.adoc[slsa_provenance_available]
a| The SLSA Provenance Available requirement states the following:
"The provenance is available to the consumer in a format that the consumer accepts. The format SHOULD be in-toto SLSA Provenance, but another format MAY be used if both producer and consumer agree and it meets all the other requirements."
This package only accepts the in-toto SLSA Provenance format.

| xref:packages/release_slsa_source_version_controlled.adoc[slsa_source_version_controlled]
a| The SLSA requirement states the following:
"Every change to the source is tracked in a version control system that meets the following requirements:

  [Change history] There exists a record of the history of changes
  that went into the revision. Each change must contain: the
  identities of the uploader and reviewers (if any), timestamps of
  the reviews (if any) and submission, the change
  description/justification, the content of the change, and the
  parent revisions.

  [Immutable reference] There exists a way to indefinitely reference
  this particular, immutable revision. In git, this is the {repo URL +
  branch/tag/ref + commit ID}.

Most popular version control system meet this requirement, such as git, Mercurial, Subversion, or Perforce."
This package verifies the requirement by asserting the image was built from a git repository.

| xref:packages/release_slsa_source_correlated.adoc[slsa_source_correlated]
a| SLSA v1 verification model states:
"...artifacts are verified to ensure they meet the producer defined expectations of where the package source code was retrieved from..."
This package correlates the provided source code reference with the source code referenced in the attestation.

| xref:packages/release_sbom_spdx.adoc[sbom_spdx]
a| Checks different properties of the CycloneDX SBOMs associated with the image being validated.

| xref:packages/release_schedule.adoc[schedule]
a| Rules that verify the current date conform to a given schedule.

| xref:packages/release_source_image.adoc[source_image]
a| This package is reponsible for verifying the source container image associated with the image being validated.

| xref:packages/release_attestation_task_bundle.adoc[attestation_task_bundle]
a| To be able to reproduce and audit builds accurately it's important to know exactly what happened during the build. To do this Conforma requires that all tasks are defined in a set of known and trusted task bundles. This package includes rules to confirm that the tasks that built the image were defined in task bundles, and that the task bundles used are from the list of known and trusted bundles.

| xref:packages/release_tasks.adoc[tasks]
a| Conforma expects that a set of tasks were included in the pipeline build for each image to be released. This package includes a set of rules to verify that the expected tasks ran in the pipeline when the image was built. Required tasks for a pipeline are specified in a data source provided at runtime. This data source features two primary rule data keys: pipeline-required-tasks and required-tasks. The pipeline-required-tasks key lists all required tasks broken down by pipeline name, while required-tasks details a default or baseline set of tasks. If your pipeline corresponds to an entry under pipeline-required-tasks, those tasks will be prioritized; otherwise, the system will default to the tasks listed under required-tasks. Required tasks are listed by the names given to them within the task definition. Optionally invocation parameter of a Task can be also mandated by including the name and the value in square brackets following the name of the task. For example: name[PARAM=val]. Only single parameter is supported, to assert multiple parameters repeat the required task definition for each parameter seperately.

| xref:packages/release_test.adoc[test]
a| Conforma requires that each build was subjected to a set of tests and that those tests all passed. This package includes a set of rules to verify that.

| xref:packages/release_trusted_task.adoc[trusted_task]
a| This package is used to verify all the Tekton Tasks involved in building the image are trusted. Trust is established by comparing the Task references found in the SLSA Provenance with a pre-defined list of trusted Tasks, which is expected to be provided as a data source that creates the `data.trusted_tasks` in the format demonstrated at https://github.com/conforma/policy/blob/main/example/data/trusted_tekton_tasks.yml. The list can be extended or customized using the `trusted_tasks` rule data key which is merged into the `trusted_tasks` data.

| xref:packages/release_rpm_ostree_task.adoc[rpm_ostree_task]
a| This package is responsible for verifying the rpm-ostree Tekton Task was executed with the expected parameters.

|===
